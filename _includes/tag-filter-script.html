<!-- Tag Filter Script -->
<script>
// Global function for onclick handlers
function filterByTag(selectedTag) {
  console.log('Filtering by tag: ' + selectedTag);
  
  var tagButtons = document.querySelectorAll('.tag-filter-btn');
  var postItems = document.querySelectorAll('.post-item');
  
  // Update active button
  for (var i = 0; i < tagButtons.length; i++) {
    tagButtons[i].classList.remove('active');
  }
  
  // Find and activate the clicked button
  for (var i = 0; i < tagButtons.length; i++) {
    var button = tagButtons[i];
    var buttonTag = button.getAttribute('data-tag') || 'all';
    if (buttonTag === selectedTag) {
      button.classList.add('active');
      break;
    }
  }
  
  // Filter posts
  for (var i = 0; i < postItems.length; i++) {
    var post = postItems[i];
    var postTags = post.getAttribute('data-tags').split(',');
    
    if (selectedTag === 'all' || postTags.indexOf(selectedTag) !== -1) {
      post.style.display = 'block';
    } else {
      post.style.display = 'none';
    }
  }
  
  // Hide year headers that have no visible posts
  var yearHeaders = document.querySelectorAll('.archive__subtitle');
  for (var j = 0; j < yearHeaders.length; j++) {
    var header = yearHeaders[j];
    var nextElements = [];
    var nextElement = header.nextElementSibling;
    
    while (nextElement && !nextElement.classList.contains('archive__subtitle')) {
      if (nextElement.classList.contains('post-item')) {
        nextElements.push(nextElement);
      }
      nextElement = nextElement.nextElementSibling;
    }
    
    var hasVisiblePosts = false;
    for (var k = 0; k < nextElements.length; k++) {
      if (nextElements[k].style.display !== 'none') {
        hasVisiblePosts = true;
        break;
      }
    }
    
    header.style.display = hasVisiblePosts ? 'block' : 'none';
  }
}

// Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
  console.log('Tag filter script loaded');
  var tagButtons = document.querySelectorAll('.tag-filter-btn');
  var postItems = document.querySelectorAll('.post-item');
  console.log('Found ' + tagButtons.length + ' tag buttons and ' + postItems.length + ' post items');
});
</script>
